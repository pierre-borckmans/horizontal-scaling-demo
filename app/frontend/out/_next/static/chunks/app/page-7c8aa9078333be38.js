(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8075:function(e,t,l){Promise.resolve().then(l.bind(l,6288))},6288:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return b}});var a=l(7437),r=l(2265),s=l(165),n=l(1110),i=l(9222),c=l(981),o=l.n(c),h=l(6470),d=l.n(h);function f(e){let{index:t,trains:l,ip:r,totalTracks:s}=e;return(0,a.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center gap-2 px-4 pt-10",children:[(0,a.jsxs)("div",{className:"relative flex h-[1vw] w-full border-b-2 border-t-2 border-[#5bade0cc]",style:{background:"linear-gradient(90deg,\n          rgb(255 255 255/0) 0%,\n          hsla(220, 62%, 25%, .5) 15%,\n          hsla(220, 62%, 25%, .5) 85%,\n          rgb(255 255 255/0) 100%)"},children:[(0,a.jsx)("div",{className:"flex h-full w-full",style:{background:"linear-gradient(\n              to right,\n              #0000 1px,\n              #305973 3px,\n              #0000 0px\n              )",backgroundSize:"3% 100%"}}),l.map(e=>(0,a.jsx)("div",{className:"absolute h-full w-full items-center justify-center transition-all",style:{top:100===e.position||e.position<8?((s+1)/2-t)*80:"calc(50% - 12.5px)",left:e.position<5?"calc(0% - 400px)":100===e.position?"calc(100% + 76px)":"".concat(.95*e.position,"%"),transformOrigin:"center left",transitionDuration:"".concat(e.position<5||100===e.position?.8:.3,"s"),opacity:100===e.position?0:1,transitionTimingFunction:100===e.position?"ease-out":"linear"},children:(0,a.jsx)(d(),{className:"transition-all",style:{width:"12%",height:25,color:e.braking?"red":100===e.position?"lightblue":"white"}})},e.id))]}),(0,a.jsxs)("span",{className:"flex items-center gap-2 text-[#4f98c4]",children:[(0,a.jsxs)("span",{className:"font-bold",children:["Track ",t+1]}),(0,a.jsxs)("span",{className:"text-xs",children:[" [",r,"]"]})]})]})}var x=l(2624),p=l.n(x),m=l(7798),u=l.n(m),g=l(7026),v=l(3969);function y(e){let{value:t,refreshTime:l}=e,[s,n]=(0,r.useState)(t);(0,r.useEffect)(()=>{if(0===t){n(0);return}n(100*Math.pow((t/100+s/100)/2,1.7))},[t,l]);let i=(0,v.v)({domain:[0,100],startAngle:90,endAngle:270,numTicks:21,diameter:200}),c=(0,r.useMemo)(()=>i.getNeedleProps({value:0,baseRadius:8,tipRadius:2}),[]);return(0,a.jsxs)("svg",{className:"w-full overflow-visible p-2",...i.getSVGProps(),children:[(0,a.jsx)("g",{id:"ticks",children:i.ticks.map(e=>{let t=i.angleToValue(e);return(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)("line",{className:(0,g.Z)(["stroke-gray-300",{"stroke-red-300":t<=20,"stroke-yellow-300":t>=60&&t<=80,"stroke-green-400":t>=80}]),strokeWidth:2,...i.getTickProps({angle:e,length:8})}),t%20==0&&(0,a.jsx)("text",{className:"fill-gray-400 text-sm font-medium",...i.getLabelProps({angle:e,offset:20}),children:t})]},"tick-group-".concat(e))})}),(0,a.jsxs)("g",{id:"needle",children:[(0,a.jsx)("circle",{className:"fill-gray-300",...c.base,r:12}),(0,a.jsx)("circle",{className:"fill-gray-700",...c.base}),(0,a.jsx)("circle",{className:"fill-gray-700",...c.tip}),(0,a.jsx)("polyline",{className:"fill-gray-700/50 transition-all duration-[300ms] ease-linear",points:c.points,style:{transform:"rotate(".concat(s/100*180,"deg)")}}),(0,a.jsx)("circle",{className:"fill-white",...c.base,r:4})]})]})}var k=l(6754),w=l.n(k);function E(){return(0,a.jsxs)("div",{className:"mb-6 flex items-center gap-8",children:[(0,a.jsx)("div",{className:"relative flex",children:(0,a.jsx)("img",{src:"/logo-dark.svg",width:44,className:"mr-1 animate-pulse blur-[0px]"})}),(0,a.jsxs)("h1",{className:"flex flex-col items-center gap-0 font-extrabold tracking-tight text-white",children:[(0,a.jsx)("span",{className:"text-2xl text-[#4f98c4]",children:"Horizontal Scaling"}),(0,a.jsxs)("div",{className:"relative flex",children:[(0,a.jsx)("span",{className:"absolute text-lg text-[#3e7698]",children:"Distributed workload"}),(0,a.jsx)("span",{className:"animate-pulse text-lg text-white/50 blur-[14px]",children:"Distributed workload"})]})]}),(0,a.jsxs)("div",{className:"relative ml-[-8px] mt-2 flex text-white/60",children:[(0,a.jsx)(w(),{height:70,className:"absolute left-0 top-0 scale-110 animate-pulse blur-[8px]"}),(0,a.jsx)(w(),{height:70})]})]})}function b(){let e="horizontal-scaling.up.railway.app",t=(0,s.NL)(),l=async()=>{let t=await i.Z.post("".concat("https","://").concat(e,"/startTrain"));return t.data},c=(0,n.D)(l,{onSuccess:()=>{t.invalidateQueries(["trains"])}}),[h,d]=(0,r.useState)([]),[x,m]=(0,r.useState)([]),[g,v]=(0,r.useState)(null),[k,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{g&&Date.now()-g>800&&0===h.length&&(w(Date.now()-g),v(null))},[g,h.length]),(0,r.useEffect)(()=>{console.log("Connecting to WebSocket");let t=new WebSocket("".concat("wss","://").concat(e,"/ws"));return t.addEventListener("open",()=>{console.log("WebSocket connection opened")}),t.addEventListener("close",()=>{console.log("WebSocket connection closed"),setTimeout(()=>t=new WebSocket("".concat("wss","://").concat(e,"/ws")))}),t.addEventListener("message",e=>{let t=JSON.parse(e.data);if(t.track&&m(e=>[...e.filter(e=>e!==t.track),t.track]),t.removed&&m(e=>[...e.filter(e=>e!==t.removed)]),!t.train)return;let l=t.train;l.track=t.track,d(e=>{let t=e.findIndex(e=>e.id===l.id);if(t>=0){let a=[...e];return a[t]=l,a}return[...e,l]}),setTimeout(()=>{100===l.position&&(console.log("TRAIN ARRIVED"),d(e=>e.filter(e=>e.id!==l.id)))},1e3)}),()=>{t.close()}},[]);let b=h.filter(e=>e.position<100).length,j=h.filter(e=>e.braking).length;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o(),{children:[(0,a.jsx)("title",{children:"Railway Horizontal Scaling"}),(0,a.jsx)("link",{rel:"icon",href:"/train1.svg"})]}),(0,a.jsxs)("main",{className:"flex h-fit min-h-screen w-full min-w-0 flex-col items-center overflow-hidden px-2 pb-8 pt-8",style:{backgroundColor:"rgb(19, 17, 28)",backgroundImage:"linear-gradient(\n              327.21deg, \n              rgba(33, 0, 75, 0.24) 3.65%, \n              rgba(60, 0, 136, 0) 40.32%\n            ), \n            linear-gradient(\n              245.93deg, \n              rgba(209, 21, 111, 0.16) 0%, \n              rgba(209, 25, 80, 0) 36.63%\n            ), \n            linear-gradient(\n              147.6deg, \n              rgba(58, 19, 255, 0) 29.79%, \n              rgba(98, 19, 255, 0.01) 85.72%\n            )"},children:[(0,a.jsx)(E,{}),(0,a.jsxs)("div",{className:"flex h-full min-h-[800px] w-full flex-col items-center gap-4 overflow-y-scroll text-white",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{className:"flex w-fit rounded border border-[#3e7698] px-2 py-1 text-[#3e7698] transition-all duration-100 hover:bg-gray-700 hover:text-[#4f98c4] hover:text-white",onClick:()=>{0===h.filter(e=>e.position<100).length&&v(Date.now()),w(null),c.mutate()},children:"Start 1 Train"}),(0,a.jsx)("button",{className:"flex w-fit rounded border border-[#3e7698] px-2 py-1 text-[#3e7698] transition-all duration-100 hover:bg-gray-700 hover:text-[#4f98c4] hover:text-white",onClick:()=>{0===h.filter(e=>e.position<100).length&&v(Date.now()),w(null);for(let e=0;e<10;e++)c.mutate()},children:"Start 10 Trains"})]}),(0,a.jsx)("div",{className:"text-lg text-white/80",children:0!==b||k||g?k?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(u(),{style:{height:20}}),(0,a.jsx)("span",{children:"Duration: ".concat((k/1e3).toFixed(3)," seconds")})]}):(0,a.jsx)("div",{children:(0,a.jsx)("span",{children:"Waiting for ".concat(b," trains to arrive...")})}):(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"italic text-white/70",children:"Let's move some trains!"})})}),(0,a.jsx)("div",{className:"mb-[-30px] flex w-32 items-center gap-1",children:(0,a.jsx)(y,{value:b?100-j/h.length*100:0,refreshTime:Date.now()})}),(0,a.jsxs)("div",{className:"flex w-full items-center text-[#3e7698]",children:[(0,a.jsx)("div",{className:"flex w-fit flex-col items-center pl-20 pr-10",children:(0,a.jsxs)("div",{className:"relative ml-[-8px] mt-2 flex",children:[(0,a.jsx)(p(),{style:{height:100,opacity:.7},className:"absolute left-0 top-0 scale-110 blur-[18px]"}),(0,a.jsx)(p(),{style:{height:100}})]})}),(0,a.jsx)("div",{className:"flex h-full w-full flex-col",children:x.sort().map((e,t)=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(f,{totalTracks:x.length,ip:e,trains:h.filter(t=>t.track===e),index:t},e)}))}),(0,a.jsx)("div",{className:"flex w-fit flex-col items-center pl-10 pr-20",children:(0,a.jsxs)("div",{className:"relative ml-[-8px] mt-2 flex",children:[(0,a.jsx)(p(),{style:{height:100,opacity:.7},className:"absolute left-0 top-0 scale-110 blur-[16px]"}),(0,a.jsx)(p(),{style:{height:100}})]})})]})]})]})]})}},6754:function(e,t,l){var a=l(2265);function r(e){return a.createElement("svg",e,a.createElement("path",{fill:"currentColor",d:"M21.756,9.194l-9.907,32.042h-1.844v-2.955L21.231,9.194H21.756z M7.159,28.656l-2.842,4.43v3.154h4.26l3.208-7.584H7.159z   M14.921,21.376h-2.733l-1.374,1.943v1.387h2.566L14.921,21.376z M16.669,16.361h-1.455l-0.723,1.03v0.736h1.364L16.669,16.361z   M18.016,12.876h-1.076l-0.528,0.761v0.542h1.008L18.016,12.876z M19.067,10.455h-0.501l-0.262,0.359v0.26h0.479L19.067,10.455z   M26.87,9.194l9.902,32.042h1.853v-2.955L27.398,9.194H26.87z M41.462,28.656h-4.617l3.199,7.584h4.273v-3.154L41.462,28.656z   M35.255,24.706h2.57v-1.387l-1.373-1.943H33.71L35.255,24.706z M32.783,18.128h1.355v-0.736l-0.728-1.03h-1.45L32.783,18.128z   M32.224,14.179v-0.542l-0.542-0.761h-1.066l0.605,1.303H32.224z M30.326,11.073v-0.26l-0.258-0.359h-0.506l0.284,0.619H30.326z   M24.056,21.376h-4.563l-0.7,3.33h5.264h0.528h5.25l-0.696-3.33h-4.554H24.056z M24.584,16.361h-0.528h-3.239l-0.43,1.767h3.669  h0.528h3.65l-0.416-1.767H24.584z M24.688,12.876h-0.745h-2.367l-0.344,1.303h2.711h0.745h2.711l-0.344-1.303H24.688z   M24.688,11.073h1.46l-0.104-0.619h-1.355h-0.745h-1.355l-0.095,0.619h1.45H24.688z M24.584,28.656h-0.528h-6.781l-2.169,7.629h8.95  h0.528h8.94l-2.178-7.629H24.584z"}))}r.defaultProps={version:"1.1",x:"0px",y:"0px",viewBox:"0 2 50 50",enableBackground:"new 0 0 50 50",xmlSpace:"preserve"},e.exports=r,r.default=r},2624:function(e,t,l){var a=l(2265);function r(e){return a.createElement("svg",e,[a.createElement("path",{fill:"currentColor",d:"M85.5,17.2L74.7,27.9v3.5V35h3.3h3.3v32.4v32.4H56.5h-25l-10.7,10.7L10,121.2v2.8c0,1.6,0.3,3.1,0.7,3.5c0.4,0.4,2,0.7,3.6,0.7h3v59.6c0,50.6,0.1,59.8,0.8,60.7c0.8,1.1,2.6,1.1,110,1.1s109.2,0,110-1.1c0.7-0.9,0.8-10.1,0.8-60.7v-59.6h3.1c3.5,0,4.2-0.7,4.2-4.5c0-2.3-0.2-2.6-10.7-13.2l-10.7-10.8h-25h-25V67.3V35h3.3h3.3v-3.5v-3.5l-10.8-10.7L159.7,6.5H128H96.3L85.5,17.2z M160.1,81.6v46.6h32.1h32.1v49.9V228h-42.7h-42.7v-21.2v-21.2H128h-10.9v21.2V228H74.4H31.8v-49.9v-49.9h32.1h32.1V81.6V35H128h32.1V81.6z",key:0}),a.createElement("g",{transform:"scale(0.045 0.045) translate(2320 1200)",key:1},[a.createElement("path",{d:"M4.756 438.175A520.713 520.713 0 0 0 0 489.735h777.799c-2.716-5.306-6.365-10.09-10.045-14.772-132.97-171.791-204.498-156.896-306.819-161.26-34.114-1.403-57.249-1.967-193.037-1.967-72.677 0-151.688.185-228.628.39-9.96 26.884-19.566 52.942-24.243 74.14h398.571v51.909H4.756ZM783.93 541.696H.399c.82 13.851 2.112 27.517 3.978 40.999h723.39c32.248 0 50.299-18.297 56.162-40.999ZM45.017 724.306S164.941 1018.77 511.46 1024c207.112 0 385.071-123.006 465.907-299.694H45.017Z",fill:"#ffffff",key:0}),a.createElement("path",{d:"M511.454 0C319.953 0 153.311 105.16 65.31 260.612c68.771-.144 202.704-.226 202.704-.226h.031v-.051c158.309 0 164.193.707 195.118 1.998l19.149.706c66.7 2.224 148.683 9.384 213.19 58.19 35.015 26.471 85.571 84.896 115.708 126.52 27.861 38.499 35.876 82.756 16.933 125.158-17.436 38.97-54.952 62.215-100.383 62.215H16.69s4.233 17.944 10.58 37.751h970.632A510.385 510.385 0 0 0 1024 512.218C1024.01 229.355 794.532 0 511.454 0Z",fill:"#ffffff",key:1})]),a.createElement("g",{fill:"white",key:2},[a.createElement("path",{d:"M45.7,156.9v14.2l10.8-0.1l10.7-0.2l0.2-14.1l0.1-14.1H56.6H45.7V156.9z",key:0}),a.createElement("path",{d:"M81.4,156.9v14.2l10.8-0.1l10.7-0.2l0.2-14.1l0.1-14.1H92.3H81.4V156.9z",key:1}),a.createElement("path",{d:"M117.1,156.9v14.2l10.8-0.1l10.7-0.2l0.2-14.1l0.1-14.1H128h-10.9V156.9z",key:2}),a.createElement("path",{d:"M152.8,156.9v14.2l10.8-0.1l10.7-0.2l0.2-14.1l0.1-14.1h-10.9h-10.9L152.8,156.9L152.8,156.9z",key:3}),a.createElement("path",{d:"M188.5,156.9v14.2l10.8-0.1l10.7-0.2l0.2-14.1l0.1-14.1h-10.9h-10.9V156.9L188.5,156.9z",key:4}),a.createElement("path",{d:"M153.1,185.7c-0.2,0.4-0.2,6.9-0.2,14.4l0.2,13.7h10.6h10.6v-14.2v-14.2l-10.5-0.2C155.7,185,153.3,185.2,153.1,185.7z",key:5}),a.createElement("path",{d:"M45.8,199.7l0.2,14.1h10.6h10.6l0.2-14.1l0.1-14.1H56.6H45.7L45.8,199.7z",key:6}),a.createElement("path",{d:"M81.5,199.7l0.2,14.1h10.6h10.6l0.2-14.1l0.1-14.1H92.3H81.4L81.5,199.7z",key:7}),a.createElement("path",{d:"M188.6,199.7l0.2,14.1h10.6H210l0.2-14.1l0.1-14.1h-10.9h-10.9L188.6,199.7z",key:8})])])}r.defaultProps={version:"1.1",x:"0px",y:"0px",viewBox:"0 0 256 256",enableBackground:"new 0 0 256 256",xmlSpace:"preserve"},e.exports=r,r.default=r},6470:function(e,t,l){var a=l(2265);function r(e){return a.createElement("svg",e,[a.createElement("g",{transform:"translate(0, 25) rotate(-90)",key:0},[a.createElement("path",{d:"M13 .5c3.072 0 5.94 2.183 8.073 5.297C23.197 8.9 24.5 12.803 24.5 16v75c0 3.22-1.099 7.38-3.116 10.727-2.022 3.355-4.889 5.773-8.384 5.773-3.05 0-5.919-2.404-8.063-5.783C2.807 98.36 1.5 94.202 1.5 91V16c0-3.197 1.303-7.1 3.427-10.203C7.06 2.683 9.928.5 13 .5Z",fill:"url(#e4sqbxb6za)",stroke:"#306EE8",key:0}),a.createElement("path",{d:"M21 85.273V84s-2.214 2.727-8 2.727S5 84 5 84v1.273S7.857 90 13 90s8-4.727 8-4.727Z",fill:"currentColor",key:1}),a.createElement("path",{d:"M7 16.5a.5.5 0 0 1 1 0v60a.5.5 0 0 1-1 0v-60Zm11 0a.5.5 0 0 1 1 0v60a.5.5 0 0 1-1 0v-60Z",fill:"#1D4596",key:2}),a.createElement("path",{d:"M20 103c-2-4.627-5.783-5-7-5-1.217 0-5 .373-7 5m18.5-35c0-4.627-9.5-5-11.5-5s-11.5.373-11.5 5m23-34c0-4.627-9.5-5-11.5-5s-11.5.373-11.5 5",stroke:"#306EE8",key:3}),a.createElement("rect",{x:"21",y:"37",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:4}),a.createElement("rect",{x:"21",y:"18",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:5}),a.createElement("rect",{x:"21",y:"71",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:6}),a.createElement("rect",{x:"21",y:"51",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:7}),a.createElement("rect",{x:"4",y:"37",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:8}),a.createElement("rect",{x:"4",y:"18",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:9}),a.createElement("rect",{x:"4",y:"51",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:10}),a.createElement("rect",{x:"4",y:"71",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:11}),a.createElement("path",{opacity:".35",d:"M11 139.4C11 125.35 8.937 97 5.5 97 2.462 97 0 125.35 0 139.4c0 6.36 2.462 10.6 5.5 10.6s5.5-5.03 5.5-10.6Z",fill:"currentColor",key:12}),a.createElement("path",{opacity:".35",d:"M26 139.4c0-14.05-2.063-42.4-5.5-42.4-3.038 0-5.5 28.35-5.5 42.4 0 6.36 2.462 10.6 5.5 10.6s5.5-5.03 5.5-10.6Z",fill:"currentColor",key:13})]),a.createElement("defs",{key:1},[a.createElement("linearGradient",{id:"e4sqbxb6za",x1:"13",y1:"0",x2:"13",y2:"108",gradientUnits:"userSpaceOnUse",key:0},[a.createElement("stop",{stopColor:"#0B1426",key:0}),a.createElement("stop",{offset:"1",stopColor:"#1A4DB3",key:1})]),a.createElement("linearGradient",{id:"1vqmv16osb",x1:"5.5",y1:"150",x2:"5.5",y2:"97",gradientUnits:"userSpaceOnUse",key:1},[a.createElement("stop",{offset:".115",stopColor:"#fff",stopOpacity:"0",key:0}),a.createElement("stop",{offset:".531",stopColor:"#999",stopOpacity:".448",key:1}),a.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:".4",key:2})]),a.createElement("linearGradient",{id:"ubdt96w3ec",x1:"20.5",y1:"150",x2:"20.5",y2:"97",gradientUnits:"userSpaceOnUse",key:2},[a.createElement("stop",{offset:".115",stopColor:"#fff",stopOpacity:"0",key:0}),a.createElement("stop",{offset:".531",stopColor:"#999",stopOpacity:".448",key:1}),a.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:".4",key:2})])])])}r.defaultProps={width:"26",height:"150",viewBox:"0 0 116 24",fill:"none"},e.exports=r,r.default=r},7798:function(e,t,l){var a=l(2265);function r(e){return a.createElement("svg",e,[a.createElement("circle",{cx:"12",cy:"12",r:"7",key:0}),a.createElement("path",{d:"M12 9v3l1.5 1.5m3.01 3.85-.35 3.83a2 2 0 0 1-2 1.82H9.83a2 2 0 0 1-2-1.82l-.35-3.83m.01-10.7.35-3.83A2 2 0 0 1 9.83 1h4.35a2 2 0 0 1 2 1.82l.35 3.83",key:1})])}r.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-watch"},e.exports=r,r.default=r}},function(e){e.O(0,[410,171,971,596,744],function(){return e(e.s=8075)}),_N_E=e.O()}]);