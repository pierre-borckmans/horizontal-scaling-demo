(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8075:function(e,t,n){Promise.resolve().then(n.bind(n,4696))},4696:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var l=n(7437),r=n(2265),a=n(165),i=n(1110),s=n(9222),c=n(981),o=n.n(c),f=n(6470),d=n.n(f);function p(e){let{trains:t,ip:n}=e;return(0,l.jsxs)("div",{className:"flex h-full w-full flex-col items-center gap-2 px-40",children:[(0,l.jsx)("div",{className:"relative flex h-[1vw] w-full",style:{background:"linear-gradient(90deg,\n          rgb(255 255 255/0) 0%,\n          hsla(220, 62%, 25%, .5) 15%,\n          hsla(220, 62%, 25%, .5) 85%,\n          rgb(255 255 255/0) 100%)"},children:t.map(e=>(0,l.jsx)("div",{className:"absolute h-full w-full items-center justify-center transition-all",style:{top:"calc(50% - 12.5px)",left:"".concat(.9*e.position,"%"),transitionTimingFunction:"linear"},children:(0,l.jsx)(d(),{className:"transition-all duration-[2000ms]",style:{width:"8%",height:25,opacity:100===e.position?0:100}})},e.id))}),"Track ",n]})}function h(){let e="horizontal-scaling.up.railway.app",t=(0,a.NL)(),n=async()=>{let t=await s.Z.post("".concat("https","://").concat(e,"/startTrain"));return t.data},c=(0,i.D)(n,{onSuccess:()=>{t.invalidateQueries(["trains"])}}),[f,d]=(0,r.useState)([]),[h,y]=(0,r.useState)([]);return(0,r.useEffect)(()=>{console.log("Connecting to WebSocket");let t=new WebSocket("".concat("wss","://").concat(e,"/ws"));return t.addEventListener("open",()=>{console.log("WebSocket connection opened")}),t.addEventListener("close",()=>{console.log("WebSocket connection closed")}),t.addEventListener("message",e=>{let t=JSON.parse(e.data);console.log(t.track),y(e=>[...e.filter(e=>e!==t.track),t.track]),d(e=>{let n=e.findIndex(e=>e.id===t.id);if(n>=0){let l=[...e];return l[n]=t,l}return[...e,t]}),setTimeout(()=>{console.log(t.position),100===t.position&&(console.log("TRAIN ARRIVED"),d(e=>e.filter(e=>e.id!==t.id)))},1e3)}),()=>{t.close()}},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(o(),{children:[(0,l.jsx)("title",{children:"Railway Horizontal Scaling"}),(0,l.jsx)("link",{rel:"icon",href:"/train1.svg"})]}),(0,l.jsx)("main",{className:"flex min-h-screen w-full min-w-0 flex-col items-center overflow-hidden px-2 pb-8 pt-4 lg:h-screen",style:{backgroundColor:"rgb(19, 17, 28)",backgroundImage:"linear-gradient(\n              327.21deg, \n              rgba(33, 0, 75, 0.24) 3.65%, \n              rgba(60, 0, 136, 0) 40.32%\n            ), \n            linear-gradient(\n              245.93deg, \n              rgba(209, 21, 111, 0.16) 0%, \n              rgba(209, 25, 80, 0) 36.63%\n            ), \n            linear-gradient(\n              147.6deg, \n              rgba(58, 19, 255, 0) 29.79%, \n              rgba(98, 19, 255, 0.01) 85.72%\n            )"},children:(0,l.jsxs)("div",{className:"flex w-full flex-col gap-4 text-white",children:[(0,l.jsx)("button",{className:"flex w-fit border px-2 py-1",onClick:()=>{c.mutate()},children:"Start Train"}),h.sort().map(e=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p,{ip:e,trains:f.filter(t=>t.track===e)},e),(0,l.jsx)(p,{ip:e,trains:f.filter(t=>t.track===e)},e),(0,l.jsx)(p,{ip:e,trains:f.filter(t=>t.track===e)},e)]}))]})})]})}},6470:function(e,t,n){var l=n(2265);function r(e){return l.createElement("svg",e,[l.createElement("g",{transform:"translate(0, 25) rotate(-90)",key:0},[l.createElement("path",{d:"M13 .5c3.072 0 5.94 2.183 8.073 5.297C23.197 8.9 24.5 12.803 24.5 16v75c0 3.22-1.099 7.38-3.116 10.727-2.022 3.355-4.889 5.773-8.384 5.773-3.05 0-5.919-2.404-8.063-5.783C2.807 98.36 1.5 94.202 1.5 91V16c0-3.197 1.303-7.1 3.427-10.203C7.06 2.683 9.928.5 13 .5Z",fill:"url(#e4sqbxb6za)",stroke:"#306EE8",key:0}),l.createElement("path",{d:"M21 85.273V84s-2.214 2.727-8 2.727S5 84 5 84v1.273S7.857 90 13 90s8-4.727 8-4.727Z",fill:"#BACFF7",key:1}),l.createElement("path",{d:"M7 16.5a.5.5 0 0 1 1 0v60a.5.5 0 0 1-1 0v-60Zm11 0a.5.5 0 0 1 1 0v60a.5.5 0 0 1-1 0v-60Z",fill:"#1D4596",key:2}),l.createElement("path",{d:"M20 103c-2-4.627-5.783-5-7-5-1.217 0-5 .373-7 5m18.5-35c0-4.627-9.5-5-11.5-5s-11.5.373-11.5 5m23-34c0-4.627-9.5-5-11.5-5s-11.5.373-11.5 5",stroke:"#306EE8",key:3}),l.createElement("rect",{x:"21",y:"37",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:4}),l.createElement("rect",{x:"21",y:"18",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:5}),l.createElement("rect",{x:"21",y:"71",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:6}),l.createElement("rect",{x:"21",y:"51",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:7}),l.createElement("rect",{x:"4",y:"37",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:8}),l.createElement("rect",{x:"4",y:"18",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:9}),l.createElement("rect",{x:"4",y:"51",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:10}),l.createElement("rect",{x:"4",y:"71",width:"1",height:"8",rx:".5",fill:"#8CAEF2",key:11}),l.createElement("path",{opacity:".5",d:"M11 139.4C11 125.35 8.937 97 5.5 97 2.462 97 0 125.35 0 139.4c0 6.36 2.462 10.6 5.5 10.6s5.5-5.03 5.5-10.6Z",fill:"url(#1vqmv16osb)",key:12}),l.createElement("path",{opacity:".5",d:"M26 139.4c0-14.05-2.063-42.4-5.5-42.4-3.038 0-5.5 28.35-5.5 42.4 0 6.36 2.462 10.6 5.5 10.6s5.5-5.03 5.5-10.6Z",fill:"url(#ubdt96w3ec)",key:13})]),l.createElement("defs",{key:1},[l.createElement("linearGradient",{id:"e4sqbxb6za",x1:"13",y1:"0",x2:"13",y2:"108",gradientUnits:"userSpaceOnUse",key:0},[l.createElement("stop",{stopColor:"#0B1426",key:0}),l.createElement("stop",{offset:"1",stopColor:"#1A4DB3",key:1})]),l.createElement("linearGradient",{id:"1vqmv16osb",x1:"5.5",y1:"150",x2:"5.5",y2:"97",gradientUnits:"userSpaceOnUse",key:1},[l.createElement("stop",{offset:".115",stopColor:"#fff",stopOpacity:"0",key:0}),l.createElement("stop",{offset:".531",stopColor:"#999",stopOpacity:".448",key:1}),l.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:".4",key:2})]),l.createElement("linearGradient",{id:"ubdt96w3ec",x1:"20.5",y1:"150",x2:"20.5",y2:"97",gradientUnits:"userSpaceOnUse",key:2},[l.createElement("stop",{offset:".115",stopColor:"#fff",stopOpacity:"0",key:0}),l.createElement("stop",{offset:".531",stopColor:"#999",stopOpacity:".448",key:1}),l.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:".4",key:2})])])])}r.defaultProps={width:"26",height:"150",viewBox:"0 0 108 24",fill:"none"},e.exports=r,r.default=r}},function(e){e.O(0,[410,203,971,596,744],function(){return e(e.s=8075)}),_N_E=e.O()}]);